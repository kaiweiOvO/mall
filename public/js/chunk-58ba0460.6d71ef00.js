(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58ba0460"],{"0254":function(e,t,s){},"2e22":function(e,t,s){},3486:function(e,t,s){},"59dd":function(e,t,s){"use strict";var r=s("944e"),a=s.n(r);a.a},"5cbe":function(e,t,s){e.exports=s.p+"img/recommend_bg.794b6628.jpg"},"5fe2":function(e,t,s){"use strict";var r=s("2e22"),a=s.n(r);a.a},"66e0":function(e,t,s){"use strict";var r=s("3486"),a=s.n(r);a.a},"8a9f":function(e,t,s){"use strict";var r=s("0254"),a=s.n(r);a.a},"944e":function(e,t,s){},b3d7:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"home"}},[s("nav-bar",{staticClass:"home-nav"},[s("div",{attrs:{slot:"center"},slot:"center"},[e._v("购物街")])]),s("tab-control",{directives:[{name:"show",rawName:"v-show",value:e.isFixed,expression:"isFixed"}],ref:"tabControl1",staticClass:"tab-control",attrs:{titles:["流行","新款","精选"]},on:{tabClick:e.tabClick}}),s("scroll",{ref:"scroll",staticClass:"content",attrs:{"probe-type":3,"pull-up-load":!0,isShowBackTop:!0},on:{scroll:e.contentScroll,pullingUp:e.loadMore}},[s("HomeSwiper",{attrs:{banners:e.banners},on:{swiperImageLoad:e.swiperImageLoad}}),s("recommend-view",{attrs:{recommends:e.recommends}}),s("feature-view"),s("tab-control",{ref:"tabControl2",attrs:{titles:["流行","新款","精选"]},on:{tabClick:e.tabClick}}),s("goods-list",{attrs:{goods:e.showGoods,showLoadMsg:!0}})],1)],1)},a=[],o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("swiper",e._l(e.banners,(function(t){return s("swiper-item",[s("a",{attrs:{href:t.link}},[s("img",{attrs:{src:t.image},on:{load:e.imageLoad}})])])})),1)},n=[],i=s("dc2c"),c={name:"HomeSwiper",data(){return{isLoad:!1}},props:{banners:{type:Array,default(){return[]}}},components:{Swiper:i["a"],SwiperItem:i["b"]},methods:{imageLoad(){this.isLoad||(this.$emit("swiperImageLoad"),this.isLoad=!0)}}},l=c,d=s("2877"),u=Object(d["a"])(l,o,n,!1,null,"87e70190",null),m=u.exports,p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"recommend"},e._l(e.recommends,(function(t){return s("div",{staticClass:"recommend-item"},[s("a",{attrs:{href:t.link}},[s("img",{attrs:{src:t.image,alt:""}}),s("div",[e._v(e._s(t.title))])])])})),0)},f=[],h={name:"RecommendView",props:{recommends:{type:Array,default(){return[]}}}},b=h,g=(s("8a9f"),Object(d["a"])(b,p,f,!1,null,"ca6e2438",null)),v=g.exports,w=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},C=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"feature"},[r("a",{attrs:{href:""}},[r("img",{attrs:{src:s("5cbe"),alt:""}})])])}],_={name:"FeatureView"},k=_,x=(s("59dd"),Object(d["a"])(k,w,C,!1,null,"21914328",null)),y=x.exports,T=s("a7ac"),$=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"tab-control"},e._l(e.titles,(function(t,r){return s("div",{staticClass:"tab-control-item",class:{active:r===e.currentIndex},on:{click:function(t){return e.itemClick(r)}}},[s("span",[e._v(e._s(t))])])})),0)},H=[],L={name:"TabControl",props:{titles:{type:Array,default(){return[]}}},data(){return{currentIndex:0}},methods:{itemClick(e){this.currentIndex=e,this.$emit("tabClick",e)}}},O=L,I=(s("66e0"),Object(d["a"])(O,$,H,!1,null,"12d6cbfa",null)),S=I.exports,j=s("6d71"),G=s("5d17"),F=(s("5762"),s("1bab"));function E(){return Object(F["a"])({url:"/home/multidata"})}function V(e,t){return Object(F["a"])({url:"home/data",params:{type:e,page:t}})}var A=s("aff8"),M={name:"Home",components:{NavBar:T["a"],HomeSwiper:m,RecommendView:v,FeatureView:y,TabControl:S,GoodsList:j["a"],Scroll:G["a"]},mixins:[A["a"]],data(){return{banners:[],recommends:[],goods:{pop:{page:0,list:[]},new:{page:0,list:[]},sell:{page:0,list:[]}},currentType:"pop",tabOffsetTop:0,isFixed:!1,saveY:0}},computed:{showGoods(){return this.goods[this.currentType].list}},methods:{getHomeData(){E().then(e=>{this.banners=e.data.banner.list,this.recommends=e.data.recommend.list})},getHomeGood(e){const t=this.goods[e].page+1;V(e,t).then(t=>{this.goods[e].list.push(...t.data.list),this.goods[e].page++})},tabClick(e){switch(e){case 0:this.currentType="pop";break;case 1:this.currentType="new";break;case 2:this.currentType="sell";break}this.$refs.tabControl1.currentIndex=e,this.$refs.tabControl2.currentIndex=e},contentScroll(e){this.isFixed=e.y<=-this.tabOffsetTop},loadMore(){this.getHomeGood(this.currentType),setTimeout(()=>{this.$refs.scroll.finishPullUp()},1e3)},swiperImageLoad(){this.tabOffsetTop=this.$refs.tabControl2.$el.offsetTop}},created(){this.getHomeData(),this.getHomeGood("pop",0),this.getHomeGood("new",0),this.getHomeGood("sell",0)},mounted(){},activated(){this.$refs.scroll.refresh(),this.isFixed=this.$refs.scroll.scroll.y<-this.tabOffsetTop},deactivated(){}},B=M,D=(s("5fe2"),Object(d["a"])(B,r,a,!1,null,"31425ef3",null));t["default"]=D.exports}}]);